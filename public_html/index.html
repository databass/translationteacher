<!DOCTYPE html>

<html>
<head>
<meta name="keywords" content="teacher translate translation talker language speech assistive technology"></meta>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22003827-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  <script type="text/javascript">

    if (!navigator.userAgent.toString().match(/chrome/i)) {
      
      window.location='chrome.html';
      
    }
  </script>

  <title>Translation Teacher</title>
  <link href="css/tt.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="js/underscore-min.js">
</script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type=
  "text/javascript">
</script>
  <script type="text/javascript" src=
  "http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js">
</script>
  <script type="text/javascript" src="js/jquery.getCursorPosition.js">
</script>
  <script src="js/parser_rules/advanced.js" type="text/javascript">
</script>
  <script src="js/wysihtml5-0.3.0.js" type="text/javascript">
</script>
  <script src="js/tt.js" type="text/javascript">
</script>
</head>

<body>
  <form>
    <h1><span style="margin-right: 72px">Translation Teacher</span></h1>

    <form class="selections">
      <div class="untranslatedLanguageSelectionContainer">
        <select id="untranslatedLanguageSelection">
          <option value="ar">
            Arabic
          </option>

          <option value="zh-CN">
            Chinese
          </option>

          <option selected="true" value="en">
            English
          </option>

          <option value="fr">
            French
          </option>

          <option value="de">
            German
          </option>

          <option value="hi">
            Hindi
          </option>

          <option value="la">
            Latin
          </option>

          <option value="ru">
            Russian
          </option>

          <option value="es">
            Spanish
          </option>

          <option value="sw">
            Swahili
          </option>

          <option value="sv">
            Swedish
          </option>

          <option value="tr">
            Turkish
          </option>
        </select>
      </div>
      
      <a title="Click the microphone to begin voice translation" class="translate-button" data-talk="true" data-language="en" data-translate="false" data-wysihtml5-command="insertSpeech" href="javascript:;" unselectable="on">
      <img src="images/Microphone-icon.png"></img>
      <div class="translate-wrapper">
       <input id="translateMicrophone" onspeechchange="tt.translateTextListener();" onwebkitspeechchange="tt.translateTextListener();"  x-webkit-speech="" speech="">
      </div>
     </a>
  

      <div class="translatedLanguageSelectionContainer">
        <select id="translatedLanguageSelection">
          <option value="ar">
            Arabic
          </option>

          <option value="zh-CN">
            Chinese
          </option>

          <option value="en">
            English
          </option>

          <option selected="true" value="fr">
            French
          </option>

          <option value="de">
            German
          </option>

          <option value="hi">
            Hindi
          </option>

          <option value="la">
            Latin
          </option>

          <option value="ru">
            Russian
          </option>

          <option value="es">
            Spanish
          </option>

          <option value="sw">
            Swahili
          </option>

          <option value="sv">
            Swedish
          </option>

          <option value="tr">
            Turkish
          </option>
        </select>
      </div>
    </form>

    <form class="text">
      <div class="untranslatedLanguageSelectionContainer">
        <div id="untranslatedToolbar" style="display: none;">
          <textarea id="untranslatedTextContainer"></textarea>
        </div>
      </div>

      <div class="translatedLanguageSelectionContainer">
        <div id="translatedToolbar" style="display: none;">
          <textarea id="translatedTextContainer"></textarea>
        </div>
      </div>

      <div style="clear:both"></div>

      <div class="untranslatedLanguageSelectionContainer">
        <div class="untranslatedControls">
          <button type="button" class="retranslate" id=
          "untranslatedLanguageSpeak">Speak</button> <button type="button" class=
          "retranslate" id="untranslatedLanguageRetranslate">Translate to</button>
        </div>
      </div>

      <div class="translatedLanguageSelectionContainer">
        <div class="translatedControls">
          <button type="button" class="retranslate" id=
          "translatedLanguageRetranslate">Translate to</button> <button type="button"
          class="retranslate" id="translatedLanguageSpeak">Speak</button>
        </div>
      </div>
    </form>

    <div style="visibility:hidden" id="log"></div>
    
    
    <script type="text/javascript">      



    var tt = TT;

    var untranslatedTextEditor = new wysihtml5.Editor("untranslatedTextContainer", {
      toolbar:      "untranslatedToolbar",
      stylesheets:  "css/stylesheet.css",
      parserRules:  wysihtml5ParserRules
    });

    untranslatedTextEditor
    .on("newcursorposition:composer", function() {
      tt.setLastCursorPosition(tt.getCurrentCursorPosition(untranslatedTextEditor));
    })

    .on("newword:composer", function() {
      tt.writeWord(tt.findSelectedWordz(untranslatedTextEditor), tt.getUntranslatedLanguage());
      tt.setLastCursorPosition(untranslatedTextEditor.composer.selection.getRange().startOffset);

    })    


    tt.setEditor('untranslated', untranslatedTextEditor);


    var translatedTextEditor = new wysihtml5.Editor("translatedTextContainer", {
      toolbar:      "translatedToolbar",
      stylesheets:  "css/stylesheet.css",
      parserRules:  wysihtml5ParserRules
    });

    translatedTextEditor
    .on("newcursorposition:composer", function() {
      tt.setLastCursorPosition(tt.getCurrentCursorPosition(translatedTextEditor));
    })

    .on("newword:composer", function() {
      tt.writeWord(tt.findSelectedWordz(translatedTextEditor), tt.getTranslatedLanguage());
      tt.setLastCursorPosition(translatedTextEditor.composer.selection.getRange().startOffset);

    })

    tt.setEditor('translated', translatedTextEditor);





    $(document).ready(function () {




        $('#untranslatedLanguageSelection').change(function() {
                
                $('#translateMicrophone').attr('lang', $(this).val());

        });
        
        $('#untranslatedLanguageSpeak').bind('click', function() {

                tt.writeWord(tt.getUntranslatedText(),tt.getUntranslatedLanguage());
        });
        
        
        $('#untranslatedTextContainer').bind('input', function() {

        
                var sel = window.getSelection(), range, caretPos;
        
                var range = sel.getRangeAt(0);
                caretPos = range.endOffset;
        
                //tt.setCurrentCursorPosition('untranslated',caretPos);


        });

        $('#translatedLanguageSpeak').bind('click', function() {
                
                tt.writeWord(tt.getTranslatedText(),tt.getTranslatedLanguage());
        });
        
        
        $('#untranslatedLanguageRetranslate').bind('click', function() {
                
                tt.translateText(tt.getUntranslatedText(),tt.getUntranslatedLanguage(), tt.getTranslatedLanguage());
                $('#translateMicrophone').trigger('click');
        });

        
        $('#translatedLanguageRetranslate').bind('click', function() {
                
                tt.translateText(tt.getTranslatedText(),tt.getTranslatedLanguage(), tt.getUntranslatedLanguage());
                $('#translateMicrophone').trigger('click');
        });

        
        $('#untranslatedLanguageSelection').bind('change', function() {

                tt.setUntranslatedLanguage($('#untranslatedLanguageSelection option:selected').val());
                $('#untranslatedLanguageSpeak').text('Speak ' + tt.getLanguageDescription(tt.getUntranslatedLanguage()));
                $('#translatedLanguageRetranslate').text('Translate to ' + tt.getLanguageDescription(tt.getUntranslatedLanguage()));

        });
        
        $('#translatedLanguageSelection').bind('change', function() {           
                tt.setTranslatedLanguage($('#translatedLanguageSelection option:selected').val());              
                if (tt.getUntranslatedText().trim() != '') {
                  tt.translateText(tt.getUntranslatedText(),tt.getUntranslatedLanguage(), tt.getTranslatedLanguage());
                }
                $('#untranslatedLanguageRetranslate').text('Translate to ' + tt.getLanguageDescription(tt.getTranslatedLanguage()));
                 $('#translatedLanguageSpeak').text('Speak ' + tt.getLanguageDescription(tt.getTranslatedLanguage()));

        });
        tt.setTranslatedLanguage($('#translatedLanguageSelection option:selected').val());
        tt.setUntranslatedLanguage($('#untranslatedLanguageSelection option:selected').val());
        $('#untranslatedLanguageRetranslate').text('Translate to ' + tt.getLanguageDescription(tt.getTranslatedLanguage()));
        $('#translatedLanguageRetranslate').text('Translate to ' + tt.getLanguageDescription(tt.getUntranslatedLanguage()));

        $('#untranslatedLanguageSpeak').text('Speak ' + tt.getLanguageDescription(tt.getUntranslatedLanguage()));
        $('#translatedLanguageSpeak').text('Speak ' + tt.getLanguageDescription(tt.getTranslatedLanguage()));
        
    });





    </script>
  </form>

  <footer>
    <p>Translation Teacher is an experimental HTML5 language teaching tool and translator.</p>

    <p style="margin-top: 2em">For more information, please contact David Byman at david.byman@gmail.com.</p>
</footer>
</body>
</html>
